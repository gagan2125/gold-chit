import{r as u,j as e,N as P,C as H,S as z,D as J,f as K,c as N,b as d,d as Q,I as W}from"./index-CVU8XVJV.js";const Z=()=>{const[C,D]=u.useState([]),[c,S]=u.useState([]),[E,X]=u.useState(""),[M,x]=u.useState(!1),[q,g]=u.useState(!1),[F,h]=u.useState(!1),[b,f]=u.useState(null),[T,A]=u.useState(null),[V,U]=u.useState(""),B=s=>{const{value:t}=s.target;U(t)},[_,y]=u.useState({visibility:!1,message:"Something went wrong!",type:"info"}),[i,v]=u.useState({group_name:"",group_type:"",group_value:"",group_install:"",group_members:"",group_duration:"",start_date:"",end_date:"",minimum_bid:"",maximum_bid:"",commission:5,reg_fee:""}),[a,p]=u.useState({}),[o,w]=u.useState({group_name:"",group_type:"",group_value:"",group_install:"",group_members:"",group_duration:"",start_date:"",end_date:"",minimum_bid:"",maximum_bid:"",commission:5,reg_fee:""}),n=s=>{const{name:t,value:r}=s.target;v(l=>({...l,[t]:r})),p(l=>({...l,[t]:""}))},G=s=>{const t={},r=s==="addGroup"?i:o;return r.group_name.trim()||(t.group_name="Group Name is required"),r.group_type||(t.group_type="Group Type is required"),(!r.group_value||isNaN(r.group_value)||r.group_value<=0)&&(t.group_value="Group Value must be a positive number"),(!r.group_install||isNaN(r.group_install)||r.group_install<=0)&&(t.group_install="Group Installment Amount must be a positive number"),(!r.group_members||isNaN(r.group_members)||r.group_members<=0)&&(t.group_members="Group Members must be a positive number"),(!r.group_duration||isNaN(r.group_duration)||r.group_duration<=0)&&(t.group_duration="Group Duration must be a positive number"),(!r.reg_fee||isNaN(r.reg_fee)||r.reg_fee<0)&&(t.reg_fee="Registration Fee must be a zero or positive number"),r.start_date||(t.start_date="Start Date is required"),i.end_date&&!r.end_date?t.end_date="End Date is required":i.end_date&&new Date(r.end_date)<new Date(r.start_date)&&(t.end_date="End Date cannot be earlier than Start Date"),(!r.minimum_bid||isNaN(r.minimum_bid)||r.minimum_bid<=0)&&(t.minimum_bid="Minimum Bid must be a positive number"),!r.maximum_bid||isNaN(r.maximum_bid)||r.maximum_bid<=0?t.maximum_bid="Maximum Bid must be a positive number":parseFloat(r.maximum_bid)<parseFloat(r.minimum_bid)&&(t.maximum_bid="Maximum Bid must be greater than or equal to Minimum Bid"),p(t),Object.keys(t).length===0},I=async s=>{s.preventDefault();const t=G("addGroup");try{if(t){const r=await d.post("/group/add-group",i,{headers:{"Content-Type":"application/json"}});y({visibility:!0,message:"Group Added Successfully",type:"success"}),x(!1),v({group_name:"",group_type:"",group_value:"",group_install:"",group_members:"",group_duration:"",start_date:"",end_date:"",minimum_bid:"",maximum_bid:"",commission:""})}else console.log(a)}catch(r){console.error("Error adding group:",r)}};u.useEffect(()=>{(async()=>{try{const t=await d.get("/group/get-group-admin");D(t.data);const r=t.data.map((l,j)=>({_id:l._id,id:j+1,name:l.group_name,type:l.group_type.charAt(0).toUpperCase()+l.group_type.slice(1)+" Group",value:l.group_value,installment:l.group_install,members:l.group_members,date:l.createdAt,action:e.jsx("div",{className:"flex justify-center gap-2",children:e.jsx(Q,{menu:{items:[{key:"1",label:e.jsx("div",{className:"text-green-600",onClick:()=>k(l._id),children:"Edit"})},{key:"2",label:e.jsx("div",{className:"text-red-600",onClick:()=>O(l._id),children:"Delete"})}]},placement:"bottomLeft",children:e.jsx(W,{className:"text-bold"})})})}));S(r)}catch(t){console.error("Error fetching group data:",t)}})()},[]),C.filter(s=>s.group_name.toLowerCase().includes(E.toLowerCase()));const O=async s=>{try{const t=await d.get(`/group/get-by-id-group/${s}`);f(t.data),g(!0)}catch(t){console.error("Error fetching group:",t)}},k=async s=>{console.log("group id is ",s);try{const t=await d.get(`/group/get-by-id-group/${s}`),r=t.data,l=r.start_date.split("T")[0],j=r.end_date.split("T")[0];A(t.data),w({group_name:t.data.group_name,group_type:t.data.group_type,group_value:t.data.group_value,group_install:t.data.group_install,group_members:t.data.group_members,group_duration:t.data.group_duration,start_date:l,end_date:j,minimum_bid:t.data.minimum_bid,maximum_bid:t.data.maximum_bid,reg_fee:t.data.reg_fee}),h(!0),p({})}catch(t){console.error("Error fetching group:",t)}},m=s=>{console.log("updateFormData",o);const{name:t,value:r}=s.target;w(l=>({...l,[t]:r})),p({...a,[t]:""})},$=async()=>{if(b)try{await d.delete(`/group/delete-group/${b._id}`),y({message:"Group deleted successfully",type:"success",visibility:!0}),g(!1),f(null)}catch(s){console.error("Error deleting group:",s)}},L=async s=>{s.preventDefault();const t=G();try{t&&(await d.put(`/group/update-group/${T._id}`,o),h(!1),y({message:"Group updated successfully",type:"success",visibility:!0}))}catch(r){console.error("Error updating group:",r)}},R=[{key:"id",header:"SL. NO"},{key:"name",header:"Group Name"},{key:"type",header:"Group Type"},{key:"value",header:"Group Value"},{key:"installment",header:"Group Installment"},{key:"members",header:"Group Members"},{key:"action",header:"Action"}];return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(P,{visibility:!0,onGlobalSearchChangeHandler:B}),e.jsx(H,{type:_.type,isVisible:_.visibility,message:_.message}),e.jsxs("div",{className:"flex mt-20",children:[e.jsx(z,{}),e.jsxs("div",{className:"flex-grow p-7",children:[e.jsx("div",{className:"mt-6 mb-8",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Groups"}),e.jsx("button",{onClick:()=>{x(!0),p({})},className:"ml-4 bg-yellow-600 text-white px-4 py-2 rounded shadow-md hover:bg-yellow-500 transition duration-200",children:"+ Add Group"})]})}),e.jsx(J,{catcher:"_id",updateHandler:k,data:K(c,V),columns:R,exportedFileName:`Groups-${c.length>0?c[0].date.split("T")[0]+" to "+c[c.length-1].date.split("T")[0]:"empty"}.csv`}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8"})]})]}),e.jsx(N,{isVisible:M,onClose:()=>x(!1),children:e.jsxs("div",{className:"py-6 px-5 lg:px-8 text-left bg-white rounded-xl shadow-lg",children:[e.jsx("h3",{className:"mb-4 text-xl font-bold text-black",children:"Add Group"}),e.jsxs("form",{className:"space-y-6",onSubmit:I,noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-black",children:"Group Name"}),e.jsx("input",{type:"text",name:"group_name",value:i.group_name,onChange:n,placeholder:"Enter the Group Name",required:!0,className:"bg-white border border-[#d4af37] text-black text-sm rounded-lg focus:ring-[#d4af37] focus:border-[#d4af37] w-full p-2.5"}),a.group_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.group_name})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-black",children:"Group Type"}),e.jsxs("select",{name:"group_type",value:i.group_type,onChange:n,required:!0,className:"bg-white border border-[#d4af37] text-black text-sm rounded-lg focus:ring-[#d4af37] focus:border-[#d4af37] w-full p-2.5",children:[e.jsx("option",{value:"",children:"Select Group Type"}),e.jsx("option",{value:"divident",children:"Divident Group"}),e.jsx("option",{value:"double",children:"Double Group"})]}),a.group_type&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.group_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-black",children:"Minimum Amount"}),e.jsx("input",{type:"number",name:"minimum_amount",value:i.minimum_amount,onChange:n,placeholder:"Enter Minimum Amount",required:!0,className:"bg-white border border-[#d4af37] text-black text-sm rounded-lg focus:ring-[#d4af37] focus:border-[#d4af37] w-full p-2.5"}),a.minimum_amount&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.minimum_amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-black",children:"Per Member Amount"}),e.jsx("input",{type:"number",name:"per_member_amount",value:i.per_member_amount,onChange:n,placeholder:"Enter Per Member Amount",required:!0,className:"bg-white border border-[#d4af37] text-black text-sm rounded-lg focus:ring-[#d4af37] focus:border-[#d4af37] w-full p-2.5"}),a.per_member_amount&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.per_member_amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-black",children:"Commission"}),e.jsx("input",{type:"number",name:"commission",value:i.commission,onChange:n,placeholder:"Enter Commission",required:!0,className:"bg-white border border-[#d4af37] text-black text-sm rounded-lg focus:ring-[#d4af37] focus:border-[#d4af37] w-full p-2.5"}),a.commission&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.commission})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-black",children:"Minimum Group Member"}),e.jsx("input",{type:"number",name:"minimum_group_member",value:i.minimum_group_member,onChange:n,placeholder:"Enter Minimum Group Member",required:!0,className:"bg-white border border-[#d4af37] text-black text-sm rounded-lg focus:ring-[#d4af37] focus:border-[#d4af37] w-full p-2.5"}),a.minimum_group_member&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.minimum_group_member})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-black",children:"Status"}),e.jsxs("select",{name:"status",value:i.status,onChange:n,required:!0,className:"bg-white border border-[#d4af37] text-black text-sm rounded-lg focus:ring-[#d4af37] focus:border-[#d4af37] w-full p-2.5",children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),a.status&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.status})]}),e.jsx("button",{type:"submit",className:`w-full text-white bg-[#d4af37] hover:bg-[#b48a2f] hover:text-black 
        focus:ring-4 focus:outline-none focus:ring-[#d4af37] font-semibold rounded-lg text-sm px-5 py-2.5 text-center transition-all duration-300`,children:"Add Group"})]})]})}),e.jsx(N,{isVisible:F,onClose:()=>h(!1),children:e.jsxs("div",{className:"py-6 px-5 lg:px-8 text-left",children:[e.jsx("h3",{className:"mb-4 text-xl font-bold text-gray-900",children:"Update Group"}),e.jsxs("form",{className:"space-y-6",onSubmit:L,noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"email",children:"Group Name"}),e.jsx("input",{type:"text",name:"group_name",value:o.group_name,onChange:m,id:"name",placeholder:"Enter the Group Name",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),a.group_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.group_name})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"category",children:"Group Type"}),e.jsxs("select",{name:"group_type",value:o.group_type||"",onChange:m,id:"category",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5",children:[e.jsx("option",{value:"",children:"Select Group Type"}),e.jsx("option",{value:"divident",children:"Dividend Group"}),e.jsx("option",{value:"double",children:"Double Group"})]}),a.group_type&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.group_type})]}),e.jsxs("div",{className:"flex flex-row justify-between space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Group Value"}),e.jsx("input",{type:"number",name:"group_value",value:o.group_value,onChange:m,id:"text",placeholder:"Enter Group Value",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),a.group_value&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.group_value})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Group Installment Amount"}),e.jsx("input",{type:"number",name:"group_install",value:o.group_install,onChange:m,id:"text",placeholder:"Enter Group Installment Amount",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),a.group_install&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.group_install})]})]}),e.jsxs("div",{className:"flex flex-row justify-between space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Group Members"}),e.jsx("input",{type:"number",name:"group_members",value:o.group_members,onChange:m,id:"text",placeholder:"Enter Group Members",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),a.group_members&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.group_members})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Group Duration"}),e.jsx("input",{type:"number",name:"group_duration",value:o.group_duration,onChange:m,id:"text",placeholder:"Enter Group Duration",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),a.group_duration&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.group_duration})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"email",children:"Registration Fee"}),e.jsx("input",{type:"number",name:"reg_fee",value:o.reg_fee,onChange:m,id:"name",placeholder:"Enter the Registration Fee",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),a.reg_fee&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.reg_fee})]}),e.jsxs("div",{className:"flex flex-row justify-between space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Start Date"}),e.jsx("input",{type:"date",name:"start_date",value:o.start_date,onChange:m,id:"date",placeholder:"Enter the Date",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),a.start_date&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.start_date})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"End Date"}),e.jsx("input",{type:"date",name:"end_date",value:o.end_date,onChange:m,id:"date",placeholder:"Enter the Date",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),a.end_date&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.end_date})]})]}),e.jsxs("div",{className:"flex flex-row justify-between space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Minimum Bid %"}),e.jsx("input",{type:"number",name:"minimum_bid",value:o.minimum_bid,onChange:m,id:"text",placeholder:"Enter Minimum Bid",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),a.minimum_bid&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.minimum_bid})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Maximum Bid %"}),e.jsx("input",{type:"number",name:"maximum_bid",value:o.maximum_bid,onChange:m,id:"text",placeholder:"Enter Maximum Bid",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),a.maximum_bid&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.maximum_bid})]})]}),e.jsx("button",{type:"submit",className:`w-full text-white bg-blue-700 hover:bg-blue-800
              focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center`,children:"Update"})]})]})}),e.jsx(N,{isVisible:q,onClose:()=>{g(!1),f(null)},children:e.jsxs("div",{className:"py-6 px-5 lg:px-8 text-left",children:[e.jsx("h3",{className:"mb-4 text-xl font-bold text-gray-900",children:"Delete Group"}),b&&e.jsxs("form",{onSubmit:s=>{s.preventDefault(),$()},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"groupName",children:["Please enter"," ",e.jsx("span",{className:"text-primary font-bold",children:b.group_name})," ","to confirm deletion."]}),e.jsx("input",{type:"text",id:"groupName",placeholder:"Enter the Group Name",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"})]}),e.jsx("button",{type:"submit",className:`w-full text-white bg-red-700 hover:bg-red-800
          focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center`,children:"Delete"})]})]})})]})})};export{Z as default};
