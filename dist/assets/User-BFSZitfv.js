import{r as n,j as e,S as z,N as J,C as K,D as Q,c as _,b as h,d as W,I as X}from"./index-CVU8XVJV.js";const se=()=>{var k,F;const[x,U]=n.useState([]),[q,v]=n.useState([]),[P,Y]=n.useState(""),[D,f]=n.useState(!1),[$,y]=n.useState(!1),[M,N]=n.useState(!1),[p,j]=n.useState(null),[T,I]=n.useState(null),[w,c]=n.useState({visibility:!1,message:"Something went wrong!",type:"info"}),[t,b]=n.useState({}),[o,C]=n.useState({full_name:"",email:"",phone_number:"",password:"",address:"",pincode:"",adhaar_no:"",pan_no:""}),[i,E]=n.useState({full_name:"",email:"",phone_number:"",password:"",address:"",pincode:"",adhaar_no:"",pan_no:""}),[V,L]=n.useState(""),O=l=>{const{value:s}=l.target;console.log("first",s),L(s)},m=l=>{const{name:s,value:r}=l.target;C(d=>({...d,[s]:r})),b(d=>({...d,[s]:""}))},S=l=>{const s={},r=l==="addCustomer"?o:i,d={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,phone:/^[6-9]\d{9}$/,pincode:/^\d{6}$/,aadhaar:/^\d{12}$/,pan:/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/};return r.full_name.trim()||(s.full_name="Full Name is required"),r.email&&!d.email.test(r.email)&&(s.email="Invalid email format"),r.phone_number?d.phone.test(r.phone_number)||(s.phone_number="Invalid  phone number"):s.phone_number="Phone number is required",r.password||(s.password="Password is required"),r.pincode?d.pincode.test(r.pincode)||(s.pincode="Invalid pincode (6 digits required)"):s.pincode="Pincode is required",r.adhaar_no?d.aadhaar.test(r.adhaar_no)||(s.adhaar_no="Invalid Aadhaar number (12 digits required)"):s.adhaar_no="Aadhaar number is required",r.pan_no&&!d.pan.test(r.pan_no.toUpperCase())&&(s.pan_no="Invalid PAN format (e.g., ABCDE1234F)"),r.address.trim()?r.address.trim().length<3&&(s.address="Address should be at least 3 characters"):s.address="Address is required",b(s),Object.keys(s).length===0},H=async l=>{var r,d;if(l.preventDefault(),S("addCustomer"))try{const a=await h.post("/user/add-user",o,{headers:{"Content-Type":"application/json"}});c({type:"success",message:"User Added Successfully",visibility:!0}),f(!1),b({}),C({full_name:"",email:"",phone_number:"",password:"",address:"",pincode:"",adhaar_no:"",pan_no:""})}catch(a){console.error("Error adding user:",a),a.response&&a.response.data&&a.response.data.message?c({type:"error",message:`${(d=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:d.message}`,visibility:!0}):c({type:"error",message:"An unexpected error occurred. Please try again.",visibility:!0})}};n.useEffect(()=>{(async()=>{try{const s=await h.get("/user/get-user");U(s.data);const r=s.data.map((a,g)=>({_id:a._id,id:g+1,date:a==null?void 0:a.createdAt,name:a.full_name,phone_number:a.phone_number,address:a.address,pincode:a.pincode,customer_id:a.customer_id,action:e.jsx("div",{className:"flex justify-center gap-2",children:e.jsx(W,{menu:{items:[{key:"1",label:e.jsx("div",{className:"text-green-600",onClick:()=>A(a._id),children:"Edit"})},{key:"2",label:e.jsx("div",{className:"text-red-600",onClick:()=>Z(a._id),children:"Delete"})}]},placement:"bottomLeft",children:e.jsx(X,{className:"text-bold"})})})}));let d=r.map(a=>{var g;return a!=null&&a.address&&typeof a.address=="string"&&((g=a==null?void 0:a.address)!=null&&g.includes(","))&&(a.address=a.address.replaceAll(","," ")),a});d||v(r),v(d)}catch(s){console.error("Error fetching user data:",s.message)}})()},[]);const G=[{key:"id",header:"SL. NO"},{key:"customer_id",header:"Customer Id"},{key:"name",header:"Customer Name"},{key:"phone_number",header:"Customer Phone Number"},{key:"address",header:"Customer Address"},{key:"pincode",header:"Customer Pincode"},{key:"action",header:"Action"}];x.filter(l=>l.full_name.toLowerCase().includes(P.toLowerCase()));const Z=async l=>{try{const s=await h.get(`/user/get-user-by-id/${l}`);j(s.data),y(!0)}catch(s){console.error("Error fetching user:",s)}},A=async l=>{try{const s=await h.get(`/user/get-user-by-id/${l}`);I(s.data),E({full_name:s.data.full_name,email:s.data.email,phone_number:s.data.phone_number,password:s.data.password,pincode:s.data.pincode,adhaar_no:s.data.adhaar_no,pan_no:s.data.pan_no,address:s.data.address}),N(!0),b({})}catch(s){console.error("Error fetching user:",s)}},u=l=>{const{name:s,value:r}=l.target;E(d=>({...d,[s]:r})),b(d=>({...d,[s]:""}))},B=async()=>{if(p)try{await h.delete(`/user/delete-user/${p._id}`),c({visibility:!0,message:"User deleted successfully",type:"success"}),y(!1),j(null)}catch(l){console.error("Error deleting user:",l)}},R=async l=>{var r,d;l.preventDefault();const s=S();try{s&&(await h.put(`/user/update-user/${T._id}`,i),N(!1),c({visibility:!0,message:"User Updated Successfully",type:"success"}))}catch(a){console.error("Error updating user:",a),a.response&&a.response.data&&a.response.data.message?c({visibility:!0,message:`${(d=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:d.message}`,type:"error"}):c({visibility:!0,message:"An unexpected error occurred. Please try again.",type:"error"})}};return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex mt-20",children:[e.jsx(z,{}),e.jsx(J,{onGlobalSearchChangeHandler:O,visibility:!0}),e.jsx(K,{type:w.type,isVisible:w.visibility,message:w.message}),e.jsxs("div",{className:"flex-grow p-7",children:[e.jsx("div",{className:"mt-6 mb-8",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Customers"}),e.jsx("button",{onClick:()=>{f(!0),b({})},className:"ml-4 bg-blue-950 text-white px-4 py-2 rounded shadow-md hover:bg-blue-800 transition duration-200",children:"+ Add Customer"})]})}),e.jsx(Q,{catcher:"_id",updateHandler:A,data:q.filter(l=>Object.values(l).some(s=>String(s).toLowerCase().includes(V.toLowerCase()))),columns:G,exportedFileName:`Customers-${x.length>0?(k=x[0])==null?void 0:k.createdAt.split("T")[0]:"NoData"}-${x.length>0?(F=x[x.length-1])==null?void 0:F.createdAt.split("T")[0]:"NoData"}.csv`})]})]}),e.jsx(_,{isVisible:D,onClose:()=>f(!1),children:e.jsxs("div",{className:"py-6 px-5 lg:px-8 text-left",children:[e.jsx("h3",{className:"mb-4 text-xl font-bold text-gray-900",children:"Add Customer"}),e.jsxs("form",{className:"space-y-6",onSubmit:H,noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"email",children:"Full Name"}),e.jsx("input",{type:"text",name:"full_name",value:o.full_name,onChange:m,id:"name",placeholder:"Enter the Full Name",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.full_name&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.full_name})]}),e.jsxs("div",{className:"flex flex-row justify-between space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:o.email,onChange:m,id:"text",placeholder:"Enter Email",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.email&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.email})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Phone Number"}),e.jsx("input",{type:"number",name:"phone_number",value:o.phone_number,onChange:m,id:"text",placeholder:"Enter Phone Number",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.phone_number&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.phone_number})]})]}),e.jsxs("div",{className:"flex flex-row justify-between space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Password"}),e.jsx("input",{type:"text",name:"password",value:o.password,onChange:m,id:"text",placeholder:"Enter Password",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.password&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.password})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Pincode"}),e.jsx("input",{type:"number",name:"pincode",value:o.pincode,onChange:m,id:"text",placeholder:"Enter Pincode",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.pincode&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.pincode})]})]}),e.jsxs("div",{className:"flex flex-row justify-between space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Adhaar Number"}),e.jsx("input",{type:"number",name:"adhaar_no",value:o.adhaar_no,onChange:m,id:"text",placeholder:"Enter Adhaar Number",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.adhaar_no&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.adhaar_no})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Pan Number"}),e.jsx("input",{type:"text",name:"pan_no",value:o.pan_no,onChange:m,id:"text",placeholder:"Enter Pan Number",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.pan_no&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.pan_no})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"email",children:"Address"}),e.jsx("input",{type:"text",name:"address",value:o.address,onChange:m,id:"name",placeholder:"Enter the Address",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.address&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.address})]}),e.jsx("button",{type:"submit",className:`w-full text-white bg-blue-700 hover:bg-blue-800
              focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center`,children:"Add"})]})]})}),e.jsx(_,{isVisible:M,onClose:()=>N(!1),children:e.jsxs("div",{className:"py-6 px-5 lg:px-8 text-left",children:[e.jsx("h3",{className:"mb-4 text-xl font-bold text-gray-900",children:"Update Customer"}),e.jsxs("form",{className:"space-y-6",onSubmit:R,noValidate:!0,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"email",children:"Full Name"}),e.jsx("input",{type:"text",name:"full_name",value:i.full_name,onChange:u,id:"name",placeholder:"Enter the Full Name",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.full_name&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.full_name})]}),e.jsxs("div",{className:"flex flex-row justify-between space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:i.email,onChange:u,id:"text",placeholder:"Enter Email",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.email&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.email})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Phone Number"}),e.jsx("input",{type:"number",name:"phone_number",value:i.phone_number,onChange:u,id:"text",placeholder:"Enter Phone Number",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.phone_number&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.phone_number})]})]}),e.jsx("div",{className:"flex flex-row justify-between space-x-4",children:e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Pincode"}),e.jsx("input",{type:"text",name:"pincode",value:i.pincode,onChange:u,id:"text",placeholder:"Enter Pincode",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.pincode&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.pincode})]})}),e.jsxs("div",{className:"flex flex-row justify-between space-x-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Adhaar Number"}),e.jsx("input",{type:"text",name:"adhaar_no",value:i.adhaar_no,onChange:u,id:"text",placeholder:"Enter Adhaar Number",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.adhaar_no&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.adhaar_no})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"date",children:"Pan Number"}),e.jsx("input",{type:"text",name:"pan_no",value:i.pan_no,onChange:u,id:"text",placeholder:"Enter Pan Number",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.pan_no&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.pan_no})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"email",children:"Address"}),e.jsx("input",{type:"text",name:"address",value:i.address,onChange:u,id:"name",placeholder:"Enter the Address",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"}),t.address&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:t.address})]}),e.jsx("button",{type:"submit",className:`w-full text-white bg-blue-700 hover:bg-blue-800
              focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center`,children:"Update"})]})]})}),e.jsx(_,{isVisible:$,onClose:()=>{y(!1),j(null)},children:e.jsxs("div",{className:"py-6 px-5 lg:px-8 text-left",children:[e.jsx("h3",{className:"mb-4 text-xl font-bold text-gray-900",children:"Delete Customer"}),p&&e.jsxs("form",{onSubmit:l=>{l.preventDefault(),B()},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-2 text-sm font-medium text-gray-900",htmlFor:"groupName",children:["Please enter"," ",e.jsx("span",{className:"text-primary font-bold",children:p.full_name})," ","to confirm deletion."]}),e.jsx("input",{type:"text",id:"groupName",placeholder:"Enter the User Full Name",required:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 w-full p-2.5"})]}),e.jsx("button",{type:"submit",className:`w-full text-white bg-red-700 hover:bg-red-800
          focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center`,children:"Delete"})]})]})})]})})};export{se as default};
